"use strict";var map,fetchNeighborhoods,fetchCuisines,fillCuisinesHTML,fillNeighborhoodsHTML,fillRestaurantsHTML,updateRestaurants,resetRestaurants,addMarkersToMap,createRestaurantHTML,loadImages,restaurants=void 0,neighborhoods=void 0,cuisines=void 0,markers=[];document.addEventListener("DOMContentLoaded",function(e){window.initMap=function(){updateRestaurants()},fetchNeighborhoods(),fetchCuisines()}),fetchNeighborhoods=function(){DBHelper.fetchRestaurants().then(function(n){var r=n.map(function(e,t){return n[t].neighborhood}),e=r.filter(function(e,t){return r.indexOf(e)==t});fillNeighborhoodsHTML(e)}).catch(function(e){return console.error(e)})},fillNeighborhoodsHTML=function(e){var n=document.getElementById("neighborhoods-select");e.forEach(function(e){var t=document.createElement("option");t.innerHTML=e,t.value=e,n.append(t)})},fetchCuisines=function(){DBHelper.fetchRestaurants().then(function(n){var r=n.map(function(e,t){return n[t].cuisine_type}),e=r.filter(function(e,t){return r.indexOf(e)==t});fillCuisinesHTML(e)}).catch(function(e){return console.error(e)})},fillCuisinesHTML=function(e){var n=document.getElementById("cuisines-select");e.forEach(function(e){var t=document.createElement("option");t.innerHTML=e,t.value=e,n.append(t)})},updateRestaurants=function(){var e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),n=e.selectedIndex,r=t.selectedIndex,a=e[n].value,s=t[r].value;DBHelper.fetchRestaurants().then(function(e){"all"!=a&&(e=e.filter(function(e){return e.cuisine_type==a})),"all"!=s&&(e=e.filter(function(e){return e.neighborhood==s})),self.restaurants=e,resetRestaurants(e),fillRestaurantsHTML()}).then(function(e){var n=document.getElementById("map");new IntersectionObserver(function(e,t){if(0<e[0].intersectionRatio){self.map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1}),setTimeout(function(){var e=document.getElementsByClassName("gm-style");e[0].children[1].setAttribute("title","Google map with restaurant locations"),e[0].children[1].contentWindow.document.childNodes[0].setAttribute("lang","en"),addMarkersToMap()},500),t.unobserve(n)}}).observe(n)})},resetRestaurants=function(e){self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers.forEach(function(e){return e.setMap(null)}),self.markers=[],self.restaurants=e},fillRestaurantsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurants,t=document.getElementById("restaurants-list");e.forEach(function(e){t.append(createRestaurantHTML(e))})},createRestaurantHTML=function(n){var e=document.createElement("li");e.classList.add("restaurant-html");var r=document.createElement("div");r.className="media-container";var t=document.createElement("div"),a=document.createElement("h1");t.className="name-container",a.innerHTML=n.name,t.append(a),r.append(t),e.append(r);var s=document.createElement("div");s.className="address-container";var o=document.createElement("p");o.innerHTML=n.neighborhood,s.append(o);var i=document.createElement("p");i.innerHTML=n.address,s.append(i),e.append(s);var c=document.createElement("div");c.className="button-container";var u=document.createElement("a");return u.innerHTML="View Details",u.href=DBHelper.urlForRestaurant(n),c.append(u),e.append(c),new IntersectionObserver(function(e,t){0<e[0].intersectionRatio&&(r.append(loadImages(n)),t.unobserve(r))}).observe(r),e},loadImages=function(e){var t=document.createElement("picture");t.className="restaurant-picture";var n=document.createElement("source");n.media="(min-width: 1024px)",n.sizes="100vw",n.srcset=DBHelper.imageUrlForRestaurant(e),t.append(n);var r=document.createElement("source");r.media="(min-width: 415px) and (max-width: 768px)",r.sizes="100vw",r.srcset=DBHelper.srcsetUrlMediumForRestaurant(e),t.append(r);var a=document.createElement("source");a.media="(max-width: 414px)",a.sizes="100vw",a.srcset=DBHelper.srcsetUrlSmallForRestaurant(e),t.append(a);var s=document.createElement("img");return s.className="restaurant-img",s.alt=DBHelper.imageAltForRestaurants(e),s.src=DBHelper.imageUrlForRestaurant(e),t.append(s),t},addMarkersToMap=function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurants).forEach(function(e){var t=DBHelper.mapMarkerForRestaurant(e,self.map);google.maps.event.addListener(t,"click",function(){window.location.href=t.url}),self.markers.push(t)})};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsibWFwIiwibmVpZ2hib3Job29kcyIsImN1aXNpbmVzIiwibWFya2VycyIsImZldGNoTmVpZ2hib3Job29kcyIsImZldGNoQ3Vpc2luZXMiLCJmaWxsQ3Vpc2luZXNIVE1MIiwiZmlsbE5laWdoYm9yaG9vZHNIVE1MIiwiZmlsbFJlc3RhdXJhbnRzSFRNTCIsInVwZGF0ZVJlc3RhdXJhbnRzIiwicmVzdGF1cmFudHMiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsIndpbmRvdyIsImluaXRNYXAiLCJEQkhlbHBlciIsImZldGNoUmVzdGF1cmFudHMiLCJ0aGVuIiwiaSIsIm5laWdoYm9yaG9vZCIsImZpbHRlcmVkIiwidiIsImluZGV4T2YiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsInNlbGVjdCIsImdldEVsZW1lbnRCeUlkIiwiZm9yRWFjaCIsIm9wdGlvbiIsImNyZWF0ZUVsZW1lbnQiLCJjdWlzaW5lX3R5cGUiLCJuZWlnYm9yaG9vZHMiLCJjdWlzaW5lIiwiaW5uZXJIVE1MIiwidmFsdWUiLCJhcHBlbmQiLCJuU2VsZWN0IiwiY0luZGV4IiwiY1NlbGVjdCIsInNlbGVjdGVkSW5kZXgiLCJuSW5kZXgiLCJyZXN1bHRzIiwiZmlsdGVyIiwiciIsInJlc2V0UmVzdGF1cmFudHMiLCJtYXBDb250YWluZXIiLCJlbnRyeSIsIm9ic2VydmVyIiwibWFwcyIsIk1hcCIsImNlbnRlciIsImxhdCIsImxuZyIsImludGVyc2VjdGlvblJhdGlvIiwibG9jIiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsImNoaWxkcmVuIiwic2V0QXR0cmlidXRlIiwiZnJhbWVzIiwiY29udGVudFdpbmRvdyIsImNoaWxkTm9kZXMiLCJzY3JvbGx3aGVlbCIsInNldFRpbWVvdXQiLCJ1bm9ic2VydmUiLCJpbm5lckRvY3VtZW50Iiwib2JzZXJ2ZSIsInNlbGYiLCJtIiwic2V0TWFwIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwidWwiLCJyZXN0YXVyYW50IiwiY3JlYXRlUmVzdGF1cmFudEhUTUwiLCJsaSIsImNsYXNzTGlzdCIsImFkZCIsIm1lZGlhQ29udGFpbmVyIiwiY2xhc3NOYW1lIiwibmFtZUNvbnRhaW5lciIsIm5hbWUiLCJhZGRyZXNzIiwiYWRkcmVzc1RleHQiLCJidXR0b24iLCJJbnRlcnNlY3Rpb25PYnNlcnZlciIsIm1vcmUiLCJocmVmIiwibG9hZEltYWdlcyIsImxhcmdlU291cmNlIiwic2l6ZXMiLCJzcmNzZXQiLCJpbWFnZVVybEZvclJlc3RhdXJhbnQiLCJwaWN0dXJlIiwibWVkaXVtU291cmNlIiwic3Jjc2V0VXJsTWVkaXVtRm9yUmVzdGF1cmFudCIsInNtYWxsU291cmNlIiwic3Jjc2V0VXJsU21hbGxGb3JSZXN0YXVyYW50IiwiaW1hZ2UiLCJzcmMiLCJpbWFnZUFsdEZvclJlc3RhdXJhbnRzIiwibWFya2VyIiwibWFwTWFya2VyRm9yUmVzdGF1cmFudCIsImdvb2dsZSIsImFkZExpc3RlbmVyIiwibG9jYXRpb24iLCJ1cmwiLCJwdXNoIl0sIm1hcHBpbmdzIjoiYUFHQSxJQUdJQSxJQURhQyxtQkFBZUMsY0FDNUJGLGlCQUNBRyxzQkFDQUMsb0JBQ0FDLGtCQUNBQyxpQkFDQUMsZ0JBQ0FDLHFCQUNBQyxXQVZKQyxpQkFBQUEsRUFBQVQsbUJBQUFBLEVBQUFDLGNBQUFBLEVBRUlRLFFBQUFBLEdBaUJKQyxTQUFTQyxpQkFBaUIsbUJBQW9CLFNBQUFDLEdBSDlDQyxPQUFBQyxRQUFBLFdBS0lOLHFCQUZKRSxxQkFDRUcsa0JBVUZWLG1CQUFxQixXQUhyQlksU0FBQUMsbUJBS0tDLEtBQUssU0FBQVIsR0FDSixJQUFNVCxFQUFnQlMsRUFBWVYsSUFIeENJLFNBQUFBLEVBQUFBLEdBQUFBLE9BQUFBLEVBQXFCZSxHQUFBQyxlQUliQyxFQUFVWCxFQUFlVSxPQUQzQixTQUFBRSxFQUFBSCxHQUFBLE9BQUFsQixFQUFBc0IsUUFBQUQsSUFBQUgsSUFLRVosc0JBQXdC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YSxzQkFXakJXLEVBQVlDLE1BQVEsUUFUcEJELEVBQUFFLE9BQUE5RSxTQUFBK0Usc0JBQUFuQixHQTdDRm9CLEVBQUExRCxPQUFBc0QsR0FnREFELElBQUFBLEVBQWFoRixTQUFBcUIsY0FBZ0IsVUFDM0JpRSxFQUFNRCxNQUFVckYsNENBQ2hCcUYsRUFBUWQsTUFBWSxRQVdwQmUsRUFBYUgsT0FBUzlFLFNBQVNrRiw2QkFBNkJ0QixHQVQ1RG9CLEVBQU1KLE9BQUFBLEdBRU5BLElBQUFBLEVBQW9CakYsU0FBcEJxQixjQUFBLFVBQ0E0RCxFQUFZRSxNQUFaLHFCQUNBRSxFQUFRMUQsTUFBT3NELFFBV2ZPLEVBQVlMLE9BQVM5RSxTQUFTb0YsNEJBQTRCeEIsR0FUMURvQixFQUFNQyxPQUFBQSxHQUVOQSxJQUFBQSxFQUFhSixTQUFRN0QsY0FBckIsT0FNQW1FLE9BTEFGLEVBQUFBLFVBQWFILGlCQUNiRSxFQUFBQSxJQUFRMUQsU0FBTzJELHVCQUFmckIsR0FXQXlCLEVBQU1DLElBQU10RixTQUFTK0Usc0JBQXNCbkIsR0FUM0NvQixFQUFNRyxPQUFBQSxHQUVOQSxHQU1BRSxnQkFBWXJGLFlBQWdDNEQsRUFBQUEsVUFBQUEsYUFBQUEsSUFBQUEsVUFBQUEsR0FBQUEsVUFBQUEsR0FBdkIyQixLQUFBQSxhQUNUdkYsUUFBQUEsU0FBQUEsR0FZVixJQUFNd0YsRUFBU3hGLFNBQVN5Rix1QkFBdUI3QixFQUFZUCxLQUFLckUsS0FUbEUwRyxPQUFPVixLQUFQbkYsTUFBQThGLFlBQUFILEVBQUEsUUFBQSxXQTVCRjFGLE9BQUE4RixTQUFBbEIsS0FBQWMsRUFBQUssTUErQkF4QyxLQUFBbEUsUUFBQTJHLEtBQUFOIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKmVzbGludC1kaXNhYmxlIG5vLXVudXNlZC12YXJzKi9cclxuLypnbG9iYWwgZ29vZ2xlICovXHJcbi8qZ2xvYmFsIERCSGVscGVyICovXHJcbi8qZXNsaW50IGxpbmVicmVhay1zdHlsZTogW1wiZXJyb3JcIiwgXCJ3aW5kb3dzXCJdKi9cclxuXHJcbmxldCByZXN0YXVyYW50cywgbmVpZ2hib3Job29kcywgY3Vpc2luZXM7XHJcbnZhciBtYXA7XHJcbnZhciBtYXJrZXJzID0gW107XHJcbnZhciBmZXRjaE5laWdoYm9yaG9vZHM7XHJcbnZhciBmZXRjaEN1aXNpbmVzO1xyXG52YXIgZmlsbEN1aXNpbmVzSFRNTDtcclxudmFyIGZpbGxOZWlnaGJvcmhvb2RzSFRNTDtcclxudmFyIGZpbGxSZXN0YXVyYW50c0hUTUw7XHJcbnZhciB1cGRhdGVSZXN0YXVyYW50cztcclxudmFyIHJlc2V0UmVzdGF1cmFudHM7XHJcbnZhciBhZGRNYXJrZXJzVG9NYXA7XHJcbnZhciBjcmVhdGVSZXN0YXVyYW50SFRNTDtcclxudmFyIGxvYWRJbWFnZXM7XHJcblxyXG4vKipcclxuICogRmV0Y2ggbmVpZ2hib3Job29kcyBhbmQgY3Vpc2luZXMgYXMgc29vbiBhcyB0aGUgcGFnZSBpcyBsb2FkZWQuXHJcbiAqL1xyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZXZlbnQgPT4ge1xyXG4gIHdpbmRvdy5pbml0TWFwID0gKCkgPT4ge1xyXG4gICAgdXBkYXRlUmVzdGF1cmFudHMoKTtcclxuICB9O1xyXG4gIGZldGNoTmVpZ2hib3Job29kcygpO1xyXG4gIGZldGNoQ3Vpc2luZXMoKTtcclxufSk7XHJcblxyXG4vKipcclxuICogRmV0Y2ggYWxsIG5laWdoYm9yaG9vZHMgYW5kIHNldCB0aGVpciBIVE1MLlxyXG4gKi9cclxuZmV0Y2hOZWlnaGJvcmhvb2RzID0gKCkgPT4ge1xyXG4gIGNvbnN0IG5laWdib3Job29kcyA9IERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKVxyXG4gICAgLnRoZW4ocmVzdGF1cmFudHMgPT4ge1xyXG4gICAgICBjb25zdCBuZWlnaGJvcmhvb2RzID0gcmVzdGF1cmFudHMubWFwKFxyXG4gICAgICAgICh2LCBpKSA9PiByZXN0YXVyYW50c1tpXS5uZWlnaGJvcmhvb2RcclxuICAgICAgKTtcclxuXHJcbiAgICAgIGNvbnN0IGZpbHRlcmVkID0gbmVpZ2hib3Job29kcy5maWx0ZXIoXHJcbiAgICAgICAgKHYsIGkpID0+IG5laWdoYm9yaG9vZHMuaW5kZXhPZih2KSA9PSBpXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBmaWxsTmVpZ2hib3Job29kc0hUTUwoZmlsdGVyZWQpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChlcnIgPT4gY29uc29sZS5lcnJvcihlcnIpKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBTZXQgbmVpZ2hib3Job29kcyBIVE1MLlxyXG4gKi9cclxuZmlsbE5laWdoYm9yaG9vZHNIVE1MID0gbmVpZ2hib3Job29kcyA9PiB7XHJcbiAgY29uc3Qgc2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25laWdoYm9yaG9vZHMtc2VsZWN0Jyk7XHJcbiAgbmVpZ2hib3Job29kcy5mb3JFYWNoKG5laWdoYm9yaG9vZCA9PiB7XHJcbiAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcclxuICAgIG9wdGlvbi5pbm5lckhUTUwgPSBuZWlnaGJvcmhvb2Q7XHJcbiAgICBvcHRpb24udmFsdWUgPSBuZWlnaGJvcmhvb2Q7XHJcbiAgICBzZWxlY3QuYXBwZW5kKG9wdGlvbik7XHJcbiAgfSk7XHJcbn07XHJcblxyXG4vKipcclxuICogRmV0Y2ggYWxsIGN1aXNpbmVzIGFuZCBzZXQgdGhlaXIgSFRNTC5cclxuICovXHJcbmZldGNoQ3Vpc2luZXMgPSAoKSA9PiB7XHJcbiAgY29uc3QgbmVpZ2Jvcmhvb2RzID0gREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygpXHJcbiAgICAudGhlbihyZXN0YXVyYW50cyA9PiB7XHJcbiAgICAgIGNvbnN0IGN1aXNpbmVzID0gcmVzdGF1cmFudHMubWFwKCh2LCBpKSA9PiByZXN0YXVyYW50c1tpXS5jdWlzaW5lX3R5cGUpO1xyXG5cclxuICAgICAgY29uc3QgZmlsdGVyZWQgPSBjdWlzaW5lcy5maWx0ZXIoKHYsIGkpID0+IGN1aXNpbmVzLmluZGV4T2YodikgPT0gaSk7XHJcblxyXG4gICAgICBmaWxsQ3Vpc2luZXNIVE1MKGZpbHRlcmVkKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goZXJyID0+IGNvbnNvbGUuZXJyb3IoZXJyKSk7XHJcbn07XHJcblxyXG4vKipcclxuICogU2V0IGN1aXNpbmVzIEhUTUwuXHJcbiAqL1xyXG5maWxsQ3Vpc2luZXNIVE1MID0gY3Vpc2luZXMgPT4ge1xyXG4gIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdWlzaW5lcy1zZWxlY3QnKTtcclxuXHJcbiAgY3Vpc2luZXMuZm9yRWFjaChjdWlzaW5lID0+IHtcclxuICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xyXG4gICAgb3B0aW9uLmlubmVySFRNTCA9IGN1aXNpbmU7XHJcbiAgICBvcHRpb24udmFsdWUgPSBjdWlzaW5lO1xyXG4gICAgc2VsZWN0LmFwcGVuZChvcHRpb24pO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFVwZGF0ZSBwYWdlIGFuZCBtYXAgZm9yIGN1cnJlbnQgcmVzdGF1cmFudHMuXHJcbiAqL1xyXG51cGRhdGVSZXN0YXVyYW50cyA9ICgpID0+IHtcclxuICBjb25zdCBjU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1aXNpbmVzLXNlbGVjdCcpO1xyXG4gIGNvbnN0IG5TZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmVpZ2hib3Job29kcy1zZWxlY3QnKTtcclxuXHJcbiAgY29uc3QgY0luZGV4ID0gY1NlbGVjdC5zZWxlY3RlZEluZGV4O1xyXG4gIGNvbnN0IG5JbmRleCA9IG5TZWxlY3Quc2VsZWN0ZWRJbmRleDtcclxuXHJcbiAgY29uc3QgY3Vpc2luZSA9IGNTZWxlY3RbY0luZGV4XS52YWx1ZTtcclxuICBjb25zdCBuZWlnaGJvcmhvb2QgPSBuU2VsZWN0W25JbmRleF0udmFsdWU7XHJcblxyXG4gIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKVxyXG4gICAgLnRoZW4ocmVzdWx0cyA9PiB7XHJcbiAgICAgIGlmIChjdWlzaW5lICE9ICdhbGwnKSB7XHJcbiAgICAgICAgLy8gZmlsdGVyIGJ5IGN1aXNpbmVcclxuICAgICAgICByZXN1bHRzID0gcmVzdWx0cy5maWx0ZXIociA9PiByLmN1aXNpbmVfdHlwZSA9PSBjdWlzaW5lKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAobmVpZ2hib3Job29kICE9ICdhbGwnKSB7XHJcbiAgICAgICAgLy8gZmlsdGVyIGJ5IG5laWdoYm9yaG9vZFxyXG4gICAgICAgIHJlc3VsdHMgPSByZXN1bHRzLmZpbHRlcihyID0+IHIubmVpZ2hib3Job29kID09IG5laWdoYm9yaG9vZCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHNlbGYucmVzdGF1cmFudHMgPSByZXN1bHRzO1xyXG4gICAgICByZXNldFJlc3RhdXJhbnRzKHJlc3VsdHMpO1xyXG4gICAgICBmaWxsUmVzdGF1cmFudHNIVE1MKCk7XHJcbiAgICB9KVxyXG4gICAgLnRoZW4obG9hZGVkID0+IHtcclxuICAgICAgY29uc3QgbWFwQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpO1xyXG4gICAgICBjb25zdCBvYnNlcnZlciA9IG5ldyBJbnRlcnNlY3Rpb25PYnNlcnZlcigoZW50cnksIG9ic2VydmVyKSA9PiB7XHJcbiAgICAgICAgaWYgKGVudHJ5WzBdLmludGVyc2VjdGlvblJhdGlvID4gMCkge1xyXG4gICAgICAgICAgbGV0IGxvYyA9IHtcclxuICAgICAgICAgICAgbGF0OiA0MC43MjIyMTYsXHJcbiAgICAgICAgICAgIGxuZzogLTczLjk4NzUwMVxyXG4gICAgICAgICAgfTtcclxuICAgICAgICAgIHNlbGYubWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJyksIHtcclxuICAgICAgICAgICAgem9vbTogMTIsXHJcbiAgICAgICAgICAgIGNlbnRlcjogbG9jLFxyXG4gICAgICAgICAgICBzY3JvbGx3aGVlbDogZmFsc2VcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHZhciBmcmFtZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdnbS1zdHlsZScpO1xyXG4gICAgICAgICAgICBmcmFtZXNbMF0uY2hpbGRyZW5bMV0uc2V0QXR0cmlidXRlKFxyXG4gICAgICAgICAgICAgICd0aXRsZScsXHJcbiAgICAgICAgICAgICAgJ0dvb2dsZSBtYXAgd2l0aCByZXN0YXVyYW50IGxvY2F0aW9ucydcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgdmFyIGlubmVyRG9jdW1lbnQgPSBmcmFtZXNbMF0uY2hpbGRyZW5bMV0uY29udGVudFdpbmRvdy5kb2N1bWVudDtcclxuICAgICAgICAgICAgaW5uZXJEb2N1bWVudC5jaGlsZE5vZGVzWzBdLnNldEF0dHJpYnV0ZSgnbGFuZycsICdlbicpO1xyXG4gICAgICAgICAgICBhZGRNYXJrZXJzVG9NYXAoKTtcclxuICAgICAgICAgIH0sIDUwMCk7XHJcbiAgICAgICAgICBvYnNlcnZlci51bm9ic2VydmUobWFwQ29udGFpbmVyKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgICBvYnNlcnZlci5vYnNlcnZlKG1hcENvbnRhaW5lcik7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBDbGVhciBjdXJyZW50IHJlc3RhdXJhbnRzLCB0aGVpciBIVE1MIGFuZCByZW1vdmUgdGhlaXIgbWFwIG1hcmtlcnMuXHJcbiAqL1xyXG5yZXNldFJlc3RhdXJhbnRzID0gcmVzdGF1cmFudHMgPT4ge1xyXG4gIC8vIFJlbW92ZSBhbGwgcmVzdGF1cmFudHNcclxuICBzZWxmLnJlc3RhdXJhbnRzID0gW107XHJcbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudHMtbGlzdCcpO1xyXG4gIHVsLmlubmVySFRNTCA9ICcnO1xyXG5cclxuICAvLyBSZW1vdmUgYWxsIG1hcCBtYXJrZXJzXHJcbiAgc2VsZi5tYXJrZXJzLmZvckVhY2gobSA9PiBtLnNldE1hcChudWxsKSk7XHJcbiAgc2VsZi5tYXJrZXJzID0gW107XHJcbiAgc2VsZi5yZXN0YXVyYW50cyA9IHJlc3RhdXJhbnRzO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSBhbGwgcmVzdGF1cmFudHMgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIHdlYnBhZ2UuXHJcbiAqL1xyXG5maWxsUmVzdGF1cmFudHNIVE1MID0gKHJlc3RhdXJhbnRzID0gc2VsZi5yZXN0YXVyYW50cykgPT4ge1xyXG4gIGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnRzLWxpc3QnKTtcclxuICByZXN0YXVyYW50cy5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xyXG5cclxuICAgIHVsLmFwcGVuZChjcmVhdGVSZXN0YXVyYW50SFRNTChyZXN0YXVyYW50KSk7XHJcblxyXG4gIH0pO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSByZXN0YXVyYW50IEhUTUwuXHJcbiAqL1xyXG5jcmVhdGVSZXN0YXVyYW50SFRNTCA9IHJlc3RhdXJhbnQgPT4ge1xyXG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcclxuICBsaS5jbGFzc0xpc3QuYWRkKCdyZXN0YXVyYW50LWh0bWwnKTtcclxuXHJcbiAgY29uc3QgbWVkaWFDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICBtZWRpYUNvbnRhaW5lci5jbGFzc05hbWUgPSAnbWVkaWEtY29udGFpbmVyJztcclxuXHJcbiAgY29uc3QgbmFtZUNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMScpO1xyXG4gIG5hbWVDb250YWluZXIuY2xhc3NOYW1lID0gJ25hbWUtY29udGFpbmVyJztcclxuICBuYW1lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcclxuICBuYW1lQ29udGFpbmVyLmFwcGVuZChuYW1lKTtcclxuICBtZWRpYUNvbnRhaW5lci5hcHBlbmQobmFtZUNvbnRhaW5lcik7XHJcblxyXG4gIGxpLmFwcGVuZChtZWRpYUNvbnRhaW5lcik7XHJcblxyXG4gIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICBhZGRyZXNzLmNsYXNzTmFtZSA9ICdhZGRyZXNzLWNvbnRhaW5lcic7XHJcblxyXG4gIGNvbnN0IG5laWdoYm9yaG9vZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICBuZWlnaGJvcmhvb2QuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uZWlnaGJvcmhvb2Q7XHJcbiAgYWRkcmVzcy5hcHBlbmQobmVpZ2hib3Job29kKTtcclxuXHJcbiAgY29uc3QgYWRkcmVzc1RleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgYWRkcmVzc1RleHQuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5hZGRyZXNzO1xyXG4gIGFkZHJlc3MuYXBwZW5kKGFkZHJlc3NUZXh0KTtcclxuXHJcbiAgbGkuYXBwZW5kKGFkZHJlc3MpO1xyXG5cclxuICBjb25zdCBtb3JlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgbW9yZS5jbGFzc05hbWUgPSAnYnV0dG9uLWNvbnRhaW5lcic7XHJcbiAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gIGJ1dHRvbi5pbm5lckhUTUwgPSAnVmlldyBEZXRhaWxzJztcclxuICBidXR0b24uaHJlZiA9IERCSGVscGVyLnVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XHJcbiAgbW9yZS5hcHBlbmQoYnV0dG9uKTtcclxuICBsaS5hcHBlbmQobW9yZSk7XHJcblxyXG4gIGNvbnN0IG9ic2VydmVyID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKChlbnRyeSwgb2JzZXJ2ZXIpID0+IHtcclxuICAgIGlmIChlbnRyeVswXS5pbnRlcnNlY3Rpb25SYXRpbyA+IDApIHtcclxuICAgICAgbWVkaWFDb250YWluZXIuYXBwZW5kKGxvYWRJbWFnZXMocmVzdGF1cmFudCkpO1xyXG4gICAgICBvYnNlcnZlci51bm9ic2VydmUobWVkaWFDb250YWluZXIpO1xyXG4gICAgfSAgICBcclxuICB9KTtcclxuICBvYnNlcnZlci5vYnNlcnZlKG1lZGlhQ29udGFpbmVyKTtcclxuXHJcbiAgcmV0dXJuIGxpO1xyXG59O1xyXG5cclxubG9hZEltYWdlcyA9IChyZXN0YXVyYW50KSA9PiB7XHJcbiAgY29uc3QgcGljdHVyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3BpY3R1cmUnKTtcclxuICBwaWN0dXJlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LXBpY3R1cmUnO1xyXG5cclxuICBjb25zdCBsYXJnZVNvdXJjZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NvdXJjZScpO1xyXG4gIGxhcmdlU291cmNlLm1lZGlhID0gJyhtaW4td2lkdGg6IDEwMjRweCknO1xyXG4gIGxhcmdlU291cmNlLnNpemVzID0gJzEwMHZ3JztcclxuICBsYXJnZVNvdXJjZS5zcmNzZXQgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XHJcbiAgcGljdHVyZS5hcHBlbmQobGFyZ2VTb3VyY2UpO1xyXG5cclxuICBjb25zdCBtZWRpdW1Tb3VyY2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzb3VyY2UnKTtcclxuICBtZWRpdW1Tb3VyY2UubWVkaWEgPSAnKG1pbi13aWR0aDogNDE1cHgpIGFuZCAobWF4LXdpZHRoOiA3NjhweCknO1xyXG4gIG1lZGl1bVNvdXJjZS5zaXplcyA9ICcxMDB2dyc7XHJcbiAgbWVkaXVtU291cmNlLnNyY3NldCA9IERCSGVscGVyLnNyY3NldFVybE1lZGl1bUZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XHJcbiAgcGljdHVyZS5hcHBlbmQobWVkaXVtU291cmNlKTtcclxuXHJcbiAgY29uc3Qgc21hbGxTb3VyY2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzb3VyY2UnKTtcclxuICBzbWFsbFNvdXJjZS5tZWRpYSA9ICcobWF4LXdpZHRoOiA0MTRweCknO1xyXG4gIHNtYWxsU291cmNlLnNpemVzID0gJzEwMHZ3JztcclxuICBzbWFsbFNvdXJjZS5zcmNzZXQgPSBEQkhlbHBlci5zcmNzZXRVcmxTbWFsbEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XHJcbiAgcGljdHVyZS5hcHBlbmQoc21hbGxTb3VyY2UpO1xyXG5cclxuICBjb25zdCBpbWFnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG4gIGltYWdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZyc7XHJcbiAgaW1hZ2UuYWx0ID0gREJIZWxwZXIuaW1hZ2VBbHRGb3JSZXN0YXVyYW50cyhyZXN0YXVyYW50KTtcclxuICBpbWFnZS5zcmMgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XHJcbiAgcGljdHVyZS5hcHBlbmQoaW1hZ2UpO1xyXG5cclxuICByZXR1cm4gcGljdHVyZTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEFkZCBtYXJrZXJzIGZvciBjdXJyZW50IHJlc3RhdXJhbnRzIHRvIHRoZSBtYXAuXHJcbiAqL1xyXG5hZGRNYXJrZXJzVG9NYXAgPSAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgcmVzdGF1cmFudHMuZm9yRWFjaChyZXN0YXVyYW50ID0+IHtcclxuICAgIC8vIEFkZCBtYXJrZXIgdG8gdGhlIG1hcFxyXG4gICAgY29uc3QgbWFya2VyID0gREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBzZWxmLm1hcCk7XHJcbiAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICdjbGljaycsICgpID0+IHtcclxuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBtYXJrZXIudXJsO1xyXG4gICAgfSk7XHJcbiAgICBzZWxmLm1hcmtlcnMucHVzaChtYXJrZXIpO1xyXG4gIH0pO1xyXG59O1xyXG4iXX0=
